<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>{% block title %}Ticket App{% endblock %}</title>
        <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 128 128%22><text y=%221.2em%22 font-size=%2296%22>ðŸŽ«</text></svg>">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
        <link rel="stylesheet" href="{{ asset('assets/styles.css') }}">
        {% block stylesheets %}{% endblock %}
    </head>
    <body class="d-flex flex-column" style="min-height: 100vh;">
        <main class="flex-fill">
            {% block body %}{% endblock %}
        </main>
        
        <footer class="footer mt-auto py-3 bg-dark text-white">
            <div class="container" style="max-width: 1440px;">
                <div class="text-center">
                    <p class="mb-0">&copy; 2025 Ticket App. All rights reserved.</p>
                </div>
            </div>
        </footer>
        
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
        {% block javascripts %}
            {% block importmap %}{{ importmap('app') }}{% endblock %}
        {% endblock %}
        <script>
            // Utility function to show toast notifications
            function showToast(message, type = 'success') {
                // Create a temporary container for the toast if it doesn't exist
                let toastContainer = document.getElementById('toast-container');
                if (!toastContainer) {
                    toastContainer = document.createElement('div');
                    toastContainer.id = 'toast-container';
                    toastContainer.className = 'toast-container position-fixed top-0 end-0 p-3';
                    toastContainer.style.zIndex = 1070;
                    document.body.appendChild(toastContainer);
                }
                
                const toast = document.createElement('div');
                toast.className = `toast ${type} border-0`;
                toast.setAttribute('role', 'alert');
                toast.innerHTML = `
                    <div class="toast-header bg-${type === 'success' ? 'success' : 'danger'} text-white">
                        <strong class="me-auto">Ticket App</strong>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="toast" aria-label="Close"></button>
                    </div>
                    <div class="toast-body bg-white">
                        ${message}
                    </div>
                `;
                
                toastContainer.appendChild(toast);
                
                const bootstrapToast = new bootstrap.Toast(toast);
                bootstrapToast.show();
                
                // Remove after it's hidden
                toast.addEventListener('hidden.bs.toast', function () {
                    toast.remove();
                });
            }
            
            // Check authentication for protected routes
            function checkAuth() {
                const protectedPaths = ['/dashboard', '/tickets'];
                const currentPath = window.location.pathname;
                
                if (protectedPaths.some(path => currentPath.startsWith(path))) {
                    const token = localStorage.getItem('ticketapp_session');
                    if (!token) {
                        window.location.href = '/auth/login';
                    }
                }
            }
            
            // Run auth check when page loads
            document.addEventListener('DOMContentLoaded', function() {
                checkAuth();
            });
        </script>
    </body>
</html>
